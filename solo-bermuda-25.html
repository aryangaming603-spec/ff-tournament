<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EXIST GAMER — Solo Tournament</title>

<style>
    :root{
        --bg:#071423; --card:#0b2430; --text:#e6fbff;
        --muted:#9fbfcc; --accent:#16a34a; --danger:#d64040;
        --pad:14px; --radius:12px; --glass:rgba(255,255,255,0.05);
    }
    body{
        margin:0;padding:0;background:var(--bg);color:var(--text);
        font-family:Inter,Arial,Helvetica,sans-serif;
    }
    .wrap{max-width:1150px;margin:0 auto;padding:14px;}
    h2{margin:0 0 12px;}
    .card{
        background:var(--card);
        padding:var(--pad);margin-top:16px;border-radius:var(--radius);
        border:1px solid var(--glass);
        box-shadow:0 4px 16px rgba(0,0,0,0.4);
    }
    label{font-size:13px;margin-bottom:4px;display:block;color:var(--muted);}
    input{
        width:100%;padding:10px;border-radius:8px;
        border:1px solid rgba(255,255,255,0.1);
        background:#051823;color:white;font-size:15px;margin-bottom:10px;
    }
    table{width:100%;border-collapse:collapse;margin-top:12px;font-size:14px;}
    th,td{
        padding:10px;border-bottom:1px solid rgba(255,255,255,0.08);
        text-align:center;
    }
    .btn{
        padding:11px 14px;border:none;font-weight:700;
        border-radius:8px;cursor:pointer;
    }
    .btn-primary{background:var(--accent);color:#02210b;}
    .btn-danger{background:var(--danger);color:white;}
    .btn-ghost{
        background:transparent;color:#aee0ff;
        border:1px solid rgba(255,255,255,0.08);
    }
    .admin-only{display:none;}
</style>
</head>

<body>
<div class="wrap">

<!-- Tournament Header -->
<div class="card">
    <h2 id="titleHeader">EXIST GAMER — Solo Tournament</h2>

    <p id="infoText" style="color:var(--muted);font-size:14px;"></p>
    <p class="small">UPI: <span id="infoUpi"></span></p>
    <p class="small">Room: <span id="infoRoom" style="font-weight:700;color:#ffd166">Not set</span></p>
    <p class="small" id="slotsInfo"></p>
    <p class="small" id="regNotice"></p>
</div>

<!-- Register -->
<div class="card">
    <h2>Register & Pay</h2>
    <label>Free Fire Name</label>
    <input id="rName" placeholder="Your in-game name">

    <label>UID</label>
    <input id="rUid" placeholder="1234567890">

    <label>WhatsApp</label>
    <input id="rWp" placeholder="10-digit number">

    <button class="btn btn-primary" onclick="regNow()">Pay & Register</button>

    <div id="qrBlock" style="text-align:center;margin-top:14px;display:none;">
        <img src="aryan-upi-qr.png" width="200" style="border-radius:12px;border:1px solid #0f2233;">
        <p style="margin-top:10px;color:#aee0ff;font-size:14px;">Scan & Pay</p>

        <button class="btn btn-primary" onclick="openUPI()">Open UPI App</button>
    </div>
</div>

<!-- Registered Players -->
<div class="card">
    <h2>Registered Players</h2>

    <table>
        <thead>
            <tr>
                <th>#</th><th>Name</th><th>UID</th><th>WhatsApp</th><th>Code</th><th>Status</th>
            </tr>
        </thead>
        <tbody id="playersTable"></tbody>
    </table>
</div>


<!-- Admin Settings -->
<div class="card admin-only" id="adminSettingsCard">
    <h2>Admin Settings</h2>

    <label>Tournament Name</label>
    <input id="setName">

    <label>Map</label>
    <input id="setMap">

    <label>Entry Fee (₹)</label>
    <input id="setFee">

    <label>Total Slots</label>
    <input id="setSlots">

    <label>Winner 1 (₹)</label>
    <input id="setP1">

    <label>Winner 2 (₹)</label>
    <input id="setP2">

    <label>Winner 3 (₹)</label>
    <input id="setP3">

    <label>Per Kill (₹)</label>
    <input id="setKill">

    <label>UPI ID</label>
    <input id="setUpi">

    <label>Registration</label>
    <select id="setReg">
        <option value="1">Open</option>
        <option value="0">Closed</option>
    </select>

    <label>Room ID</label>
    <input id="setRoomId">

    <label>Room Password</label>
    <input id="setRoomPass">

    <button class="btn btn-primary" onclick="saveSettings()">Save Settings</button>
    <button class="btn btn-danger" onclick="clearAll()">Clear Players</button>
</div>

</div>


<script>
const SKEY = "existG_settings_v2";
const PKEY = "existG_players_v2";

/* DEFAULTS */
let settings = {
    name:"EXIST GAMER",
    map:"Bermuda",
    fee:25,
    slots:48,
    p1:150, p2:100, p3:50,
    perKill:6,
    upi:"9170856377-3@ybl",
    regOpen:1,
    roomId:"",
    roomPass:""
};

let players = [];

/* LOAD */
(function(){
    const s = JSON.parse(localStorage.getItem(SKEY)||"null");
    const p = JSON.parse(localStorage.getItem(PKEY)||"null");
    if(s) settings={...settings,...s};
    if(p) players=p;

    applyUI();

    const isAdmin = location.search.includes("admin=1");
    if(isAdmin){
        document.getElementById("adminSettingsCard").style.display="block";
        loadAdminForm();
    }
})();

/* APPLY UI */
function applyUI(){
    document.getElementById("titleHeader").textContent=settings.name + " — Solo Tournament";
    document.getElementById("infoText").textContent=
      `Mode: Solo • Map: ${settings.map} • Entry: ₹${settings.fee} • Kill: ₹${settings.perKill} • Prizes: ${settings.p1}/${settings.p2}/${settings.p3}`;
    document.getElementById("infoUpi").textContent=settings.upi;
    document.getElementById("slotsInfo").textContent=`Slots: ${settings.slots} • Filled: ${players.length}`;
    document.getElementById("regNotice").textContent=settings.regOpen?"Registration OPEN":"Registration CLOSED";

    let rtxt="Not set";
    if(settings.roomId){
        rtxt = `${settings.roomId} (${settings.roomPass||"-----"})`;
    }
    document.getElementById("infoRoom").textContent=rtxt;

    renderPlayers();
}

/* REGISTER */
function regNow(){
    if(!settings.regOpen) return alert("Registration closed!");

    const n=document.getElementById("rName").value.trim();
    const u=document.getElementById("rUid").value.trim();
    const w=document.getElementById("rWp").value.trim();

    if(!n||!u||!w) return alert("Fill all fields!");

    const code = Math.random().toString(36).substring(2,7).toUpperCase();

    players.push({name:n,uid:u,wp:w,code,paid:0});
    localStorage.setItem(PKEY,JSON.stringify(players));

    applyUI();

    document.getElementById("qrBlock").style.display="block";
    alert("Registered! Now Pay using QR below.");
}

/* UPI LINK */
function openUPI(){
    const amt = settings.fee;
    const upi = settings.upi;
    const txt = "Tournament Fee";
    const link =
      `upi://pay?pa=${encodeURIComponent(upi)}&pn=EXIST%20GAMER&am=${amt}&cu=INR&tn=${encodeURIComponent(txt)}`;
    location.href=link;
}

/* PLAYERS */
function renderPlayers(){
    let html="";
    players.forEach((p,i)=>{
        html+=`
        <tr>
          <td>${i+1}</td>
          <td>${p.name}</td>
          <td>${hide(p.uid)}</td>
          <td>${hide(p.wp)}</td>
          <td>${p.code}</td>
          <td>${p.paid?"Paid":"Pending"}</td>
        </tr>`;
    });
    document.getElementById("playersTable").innerHTML=html;
}
function hide(s){return "X".repeat(s.length);}

/* ADMIN */
function loadAdminForm(){
    const ids=["setName","setMap","setFee","setSlots","setP1","setP2","setP3","setKill","setUpi","setReg","setRoomId","setRoomPass"];
    ids.forEach(id=>{
        document.getElementById(id).value = settings[id.replace("set","").toLowerCase()] || "";
    });
}

function saveSettings(){
    settings.name=document.getElementById("setName").value;
    settings.map=document.getElementById("setMap").value;
    settings.fee=Number(document.getElementById("setFee").value);
    settings.slots=Number(document.getElementById("setSlots").value);
    settings.p1=Number(document.getElementById("setP1").value);
    settings.p2=Number(document.getElementById("setP2").value);
    settings.p3=Number(document.getElementById("setP3").value);
    settings.perKill=Number(document.getElementById("setKill").value);
    settings.upi=document.getElementById("setUpi").value;
    settings.regOpen=Number(document.getElementById("setReg").value);
    settings.roomId=document.getElementById("setRoomId").value;
    settings.roomPass=document.getElementById("setRoomPass").value;

    localStorage.setItem(SKEY,JSON.stringify(settings));
    alert("Saved!");
    applyUI();
}

function clearAll(){
    if(!confirm("Clear ALL players?")) return;
    players=[];
    localStorage.removeItem(PKEY);
    applyUI();
}
</script>

</body>
</html>
