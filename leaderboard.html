<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Leaderboard — EXIST GAMER</title>
<style>
  :root{--bg:#041426;--card:#082034;--muted:#9fbfcc;--accent:#06b6d4;--radius:12px}
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,Arial;background:linear-gradient(180deg,var(--bg),#031827);color:#eafcff;padding:18px}
  .wrap{max-width:900px;margin:0 auto}
  .card{background:var(--card);padding:14px;border-radius:var(--radius);border:1px solid rgba(255,255,255,0.03);margin-bottom:12px}
  table{width:100%;border-collapse:collapse;margin-top:12px}
  th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.04);text-align:center}
  input{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:rgba(2,12,20,0.6);color:#eaffff;width:100%}
  .btn{padding:8px 10px;border-radius:8px;border:none;font-weight:700;cursor:pointer}
  .btn-primary{background:linear-gradient(90deg,var(--accent),#16a34a);color:#02120a}
  .muted{color:var(--muted)}
  .admin-only{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h2 style="margin:0">Leaderboard</h2>
    <div class="muted" style="margin-top:8px">Top positions and rewards calculated from tournament settings.</div>
  </div>

  <div class="card">
    <table>
      <thead><tr><th>#</th><th>Name</th><th>Kills</th><th>Reward</th><th class="admin-only">Action</th></tr></thead>
      <tbody id="lb_table"></tbody>
    </table>
  </div>

  <div class="card admin-only" id="adminPanel">
    <h3 style="margin:0 0 8px 0">Admin Tools</h3>
    <label>Name</label>
    <input id="aName">
    <label>Kills</label>
    <input id="aKills" type="number" value="0">
    <div style="height:8px"></div>
    <button class="btn btn-primary" onclick="addEntry()">Add</button>
    <button class="btn" onclick="clearLB()">Clear</button>
  </div>
</div>

<script>
const SKEY="existG_settings_v2", LKEY="existG_lb_v2";
let settings = JSON.parse(localStorage.getItem(SKEY)||"{}");
if(!settings.p1) settings.p1=150; if(!settings.p2) settings.p2=100; if(!settings.p3) settings.p3=50; if(!settings.perKill) settings.perKill=6;
let lb = JSON.parse(localStorage.getItem(LKEY)||"[]");
const IS_ADMIN = location.search.includes("admin=1");
if(IS_ADMIN){ document.querySelectorAll('.admin-only').forEach(e=>e.style.display='block'); document.getElementById('adminPanel').style.display='block'; }
function render(){ 
  lb = (lb||[]).sort((a,b)=>b.kills-a.kills);
  const out = lb.map((p,i)=>{
    const base = i===0?settings.p1 : i===1?settings.p2 : i===2?settings.p3 : 0;
    const reward = base + (p.kills * settings.perKill);
    return `<tr><td>${i+1}</td><td>${p.name}</td><td>${IS_ADMIN? `<input style="width:60px" value="${p.kills}" onchange="update(${i},this.value)">` : p.kills}</td><td>₹${reward}</td><td class="admin-only"><button onclick="del(${i})">Del</button></td></tr>`;
  }).join('');
  document.getElementById('lb_table').innerHTML = out;
}
render();
function addEntry(){ const n=document.getElementById('aName').value.trim(); const k=Number(document.getElementById('aKills').value||0); if(!n) return alert('Enter name'); lb.push({name:n,kills:k}); localStorage.setItem(LKEY,JSON.stringify(lb)); render(); document.getElementById('aName').value=''; document.getElementById('aKills').value=0;}
function update(i,v){ lb[i].kills = Number(v||0); localStorage.setItem(LKEY,JSON.stringify(lb)); render(); }
function del(i){ if(!confirm('Delete?')) return; lb.splice(i,1); localStorage.setItem(LKEY,JSON.stringify(lb)); render(); }
function clearLB(){ if(!confirm('Clear leaderboard?')) return; lb=[]; localStorage.setItem(LKEY,JSON.stringify(lb)); render(); }
</script>
</body>
</html>
